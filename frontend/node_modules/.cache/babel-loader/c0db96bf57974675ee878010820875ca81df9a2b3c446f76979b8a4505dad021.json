{"ast":null,"code":"import _objectSpread from\"C:/Users/faoa1/OneDrive/Escritorio/Sobis/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useState,useEffect}from\"react\";import Button from'react-bootstrap/Button';import axios from\"axios\";import{useNavigate}from\"react-router-dom\";import RelationshipTable from\"../components/RelationshipTable\";import RelationshipModal from\"../components/RelationshipModal\";import NavScrollExample from\"../components/Navbar\";import{Link}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Relationship=()=>{const navigate=useNavigate();const[modal,setModal]=useState(false);const[relationships,setRelationships]=useState([]);const[streak,setStreak]=useState({});const[formData,setFormData]=useState({estatus:\"Good\",note:\"\",dessert:false,empaty:\"\",comprehension:\"\",curiosity:\"\",learn_more:\"\",learn_from_you:\"\",miracle:\"\",username:localStorage.getItem(\"username\"),create:new Date().toISOString().split('T')[0]});const username=localStorage.getItem(\"username\");useEffect(()=>{loadRelationships();},[]);const loadRelationships=async()=>{const token=localStorage.getItem(\"token\");const username=localStorage.getItem(\"username\");if(!token||!username)return navigate(\"/login\");try{const res=await axios.get(\"http://localhost:8000/api/relationship/\",{headers:{Authorization:\"Bearer \".concat(token)},params:{username}// <-- aquí agregas el parámetro\n});setRelationships(res.data.relationships);setStreak(res.data.streak);}catch(err){if(err.response&&err.response.status===401){navigate(\"/login\");}else{console.error(err);}}};const toggle=async function(){let relationshipId=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(relationshipId){const token=localStorage.getItem(\"token\");if(!token)return navigate(\"/login\");try{const res=await axios.get(\"http://localhost:8000/api/relationship/\".concat(relationshipId,\"/\"),{headers:{Authorization:\"Bearer \".concat(token)}});const relation=res.data;setFormData(_objectSpread(_objectSpread({},relation),{},{create:relation.create.split('-').reverse().join('-')}));}catch(err){if(err.response&&err.response.status===401){navigate(\"/login\");}else{console.error(err);}}}else{setFormData({estatus:\"Good\",note:\"\",dessert:false,empaty:\"\",comprehension:\"\",curiosity:\"\",learn_more:\"\",learn_from_you:\"\",miracle:\"\",username:localStorage.getItem(\"username\"),create:new Date().toISOString().split('T')[0]});}setModal(!modal);};const handleSubmit=async e=>{e.preventDefault();const token=localStorage.getItem(\"token\");if(!token)return navigate(\"/login\");try{await axios.post(\"http://localhost:8000/api/relationship/\",formData,{headers:{Authorization:\"Bearer \".concat(token)}});toggle();loadRelationships();}catch(err){if(err.response&&err.response.status===401){navigate(\"/login\");}else{console.error(err);}}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NavScrollExample,{}),/*#__PURE__*/_jsx(Button,{as:Link,to:\"/dashboard\",variant:\"primary\",children:\"Ir a Dashboard\"}),/*#__PURE__*/_jsx(Button,{as:Link,to:\"/finances\",variant:\"primary\",children:\"Ir a Finanzas\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Relaciones \",username]}),/*#__PURE__*/_jsx(Button,{color:\"primary\",onClick:()=>toggle(),children:\"Agregar Relaci\\xF3n\"}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"Racha: \",streak.streak||0,\" d\\xEDa(s)\"]}),/*#__PURE__*/_jsx(RelationshipTable,{relationships:relationships,onRowClick:toggle}),/*#__PURE__*/_jsx(RelationshipModal,{isOpen:modal,toggle:toggle,formData:formData,setFormData:setFormData,handleSubmit:handleSubmit})]})]});};export default Relationship;","map":{"version":3,"names":["useState","useEffect","Button","axios","useNavigate","RelationshipTable","RelationshipModal","NavScrollExample","Link","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Relationship","navigate","modal","setModal","relationships","setRelationships","streak","setStreak","formData","setFormData","estatus","note","dessert","empaty","comprehension","curiosity","learn_more","learn_from_you","miracle","username","localStorage","getItem","create","Date","toISOString","split","loadRelationships","token","res","get","headers","Authorization","concat","params","data","err","response","status","console","error","toggle","relationshipId","arguments","length","undefined","relation","_objectSpread","reverse","join","handleSubmit","e","preventDefault","post","children","as","to","variant","color","onClick","onRowClick","isOpen"],"sources":["C:/Users/faoa1/OneDrive/Escritorio/Sobis/frontend/src/pages/Relationship.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport Button from 'react-bootstrap/Button';\r\nimport axios from \"axios\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport RelationshipTable from \"../components/RelationshipTable\";\r\nimport RelationshipModal from \"../components/RelationshipModal\";\r\nimport NavScrollExample from \"../components/Navbar\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nconst Relationship = () => {\r\n    const navigate = useNavigate();\r\n    const [modal, setModal] = useState(false);\r\n    const [relationships, setRelationships] = useState([]);\r\n    const [streak, setStreak] = useState({});\r\n    const [formData, setFormData] = useState({\r\n        estatus: \"Good\",\r\n        note: \"\",\r\n        dessert: false,\r\n        empaty: \"\",\r\n        comprehension: \"\",\r\n        curiosity: \"\",\r\n        learn_more: \"\",\r\n        learn_from_you: \"\",\r\n        miracle: \"\",\r\n        username: localStorage.getItem(\"username\"),\r\n        create: new Date().toISOString().split('T')[0],\r\n    });\r\n\r\n    const username = localStorage.getItem(\"username\");\r\n\r\n    useEffect(() => {\r\n        loadRelationships();\r\n    }, []);\r\n\r\n    const loadRelationships = async () => {\r\n        const token = localStorage.getItem(\"token\");\r\n        const username = localStorage.getItem(\"username\");\r\n        if (!token || !username) return navigate(\"/login\");\r\n        try {\r\n            const res = await axios.get(\"http://localhost:8000/api/relationship/\", {\r\n                headers: { Authorization: `Bearer ${token}` },\r\n                params: { username } // <-- aquí agregas el parámetro\r\n            });\r\n            setRelationships(res.data.relationships);\r\n            setStreak(res.data.streak);\r\n        } catch (err) {\r\n            if (err.response && err.response.status === 401) {\r\n                navigate(\"/login\");\r\n            } else {\r\n                console.error(err);\r\n            }\r\n        }\r\n    };\r\n\r\n    const toggle = async (relationshipId = null) => {\r\n        if (relationshipId) {\r\n            const token = localStorage.getItem(\"token\");\r\n            if (!token) return navigate(\"/login\");\r\n            try {\r\n                const res = await axios.get(`http://localhost:8000/api/relationship/${relationshipId}/`, {\r\n                    headers: { Authorization: `Bearer ${token}` }\r\n                });\r\n                const relation = res.data;\r\n                setFormData({\r\n                    ...relation,\r\n                    create: relation.create.split('-').reverse().join('-'),\r\n                });\r\n            } catch (err) {\r\n                if (err.response && err.response.status === 401) {\r\n                    navigate(\"/login\");\r\n                } else {\r\n                    console.error(err);\r\n                }\r\n            }\r\n        } else {\r\n            setFormData({\r\n                estatus: \"Good\",\r\n                note: \"\",\r\n                dessert: false,\r\n                empaty: \"\",\r\n                comprehension: \"\",\r\n                curiosity: \"\",\r\n                learn_more: \"\",\r\n                learn_from_you: \"\",\r\n                miracle: \"\",\r\n                username: localStorage.getItem(\"username\"),\r\n                create: new Date().toISOString().split('T')[0],\r\n            });\r\n        }\r\n        setModal(!modal);\r\n    };\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        const token = localStorage.getItem(\"token\");\r\n        if (!token) return navigate(\"/login\");\r\n        try {\r\n            await axios.post(\"http://localhost:8000/api/relationship/\", formData, {\r\n                headers: { Authorization: `Bearer ${token}` }\r\n            });\r\n            toggle();\r\n            loadRelationships();\r\n        } catch (err) {\r\n            if (err.response && err.response.status === 401) {\r\n                navigate(\"/login\");\r\n            } else {\r\n                console.error(err);\r\n            }\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n        <NavScrollExample />\r\n      <Button as={Link} to=\"/dashboard\" variant=\"primary\">\r\n        Ir a Dashboard\r\n      </Button>\r\n        <Button as={Link} to=\"/finances\" variant=\"primary\">\r\n        Ir a Finanzas\r\n      </Button>\r\n        <div>\r\n            <h2>Relaciones {username}</h2>\r\n            <Button color=\"primary\" onClick={() => toggle()}>Agregar Relación</Button>\r\n            <h3>Racha: {streak.streak || 0} día(s)</h3>\r\n            <RelationshipTable relationships={relationships} onRowClick={toggle} />\r\n            <RelationshipModal isOpen={modal} toggle={toggle} formData={formData} setFormData={setFormData} handleSubmit={handleSubmit} />\r\n        </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default Relationship;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}