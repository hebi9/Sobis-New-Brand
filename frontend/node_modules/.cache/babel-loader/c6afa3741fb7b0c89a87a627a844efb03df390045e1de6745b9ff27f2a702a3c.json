{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\faoa1\\\\OneDrive\\\\Escritorio\\\\Sobis\\\\frontend\\\\src\\\\pages\\\\Relationship.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport Button from 'react-bootstrap/Button';\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\nimport RelationshipTable from \"../components/RelationshipTable\";\nimport RelationshipModal from \"../components/RelationshipModal\";\nimport NavScrollExample from \"../components/Navbar\";\nimport { Link } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Relationship = () => {\n  _s();\n  const navigate = useNavigate();\n  const [modal, setModal] = useState(false);\n  const [relationships, setRelationships] = useState([]);\n  const [streak, setStreak] = useState({});\n  const [formData, setFormData] = useState({\n    estatus: \"Good\",\n    note: \"\",\n    dessert: false,\n    empaty: \"\",\n    comprehension: \"\",\n    curiosity: \"\",\n    learn_more: \"\",\n    learn_from_you: \"\",\n    miracle: \"\",\n    username: localStorage.getItem(\"username\"),\n    create: new Date().toISOString().split('T')[0]\n  });\n  const username = localStorage.getItem(\"username\");\n  useEffect(() => {\n    loadRelationships();\n  }, []);\n  const loadRelationships = async () => {\n    const token = localStorage.getItem(\"token\");\n    const username = localStorage.getItem(\"username\");\n    if (!token || !username) return navigate(\"/login\");\n    try {\n      const res = await axios.get(\"http://localhost:8000/api/relationship/\", {\n        headers: {\n          Authorization: `Bearer ${token}`\n        },\n        params: {\n          username\n        } // <-- aquí agregas el parámetro\n      });\n      setRelationships(res.data.relationships);\n      setStreak(res.data.streak);\n    } catch (err) {\n      if (err.response && err.response.status === 401) {\n        navigate(\"/login\");\n      } else {\n        console.error(err);\n      }\n    }\n  };\n  const toggle = async (relationshipId = null) => {\n    if (relationshipId) {\n      const token = localStorage.getItem(\"token\");\n      if (!token) return navigate(\"/login\");\n      try {\n        const res = await axios.get(`http://localhost:8000/api/relationship/${relationshipId}/`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        const relation = res.data;\n        setFormData({\n          ...relation,\n          create: relation.create.split('-').reverse().join('-')\n        });\n      } catch (err) {\n        if (err.response && err.response.status === 401) {\n          navigate(\"/login\");\n        } else {\n          console.error(err);\n        }\n      }\n    } else {\n      setFormData({\n        estatus: \"Good\",\n        note: \"\",\n        dessert: false,\n        empaty: \"\",\n        comprehension: \"\",\n        curiosity: \"\",\n        learn_more: \"\",\n        learn_from_you: \"\",\n        miracle: \"\",\n        username: localStorage.getItem(\"username\"),\n        create: new Date().toISOString().split('T')[0]\n      });\n    }\n    setModal(!modal);\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const token = localStorage.getItem(\"token\");\n    if (!token) return navigate(\"/login\");\n    try {\n      await axios.post(\"http://localhost:8000/api/relationship/\", formData, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      toggle();\n      loadRelationships();\n    } catch (err) {\n      if (err.response && err.response.status === 401) {\n        navigate(\"/login\");\n      } else {\n        console.error(err);\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(NavScrollExample, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      as: Link,\n      to: \"/dashboard\",\n      variant: \"primary\",\n      children: \"Ir a Dashboard\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      as: Link,\n      to: \"/finances\",\n      variant: \"primary\",\n      children: \"Ir a Finanzas\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: [\"Relaciones \", username]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        color: \"primary\",\n        onClick: () => toggle(),\n        children: \"Agregar Relaci\\xF3n\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: [\"Racha: \", streak.streak || 0, \" d\\xEDa(s)\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(RelationshipTable, {\n        relationships: relationships,\n        onRowClick: toggle\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(RelationshipModal, {\n        isOpen: modal,\n        toggle: toggle,\n        formData: formData,\n        setFormData: setFormData,\n        handleSubmit: handleSubmit\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n};\n_s(Relationship, \"YQDs+DGr/C/rQYIva9WCeh7BtZE=\", false, function () {\n  return [useNavigate];\n});\n_c = Relationship;\nexport default Relationship;\nvar _c;\n$RefreshReg$(_c, \"Relationship\");","map":{"version":3,"names":["useState","useEffect","Button","axios","useNavigate","RelationshipTable","RelationshipModal","NavScrollExample","Link","jsxDEV","_jsxDEV","Fragment","_Fragment","Relationship","_s","navigate","modal","setModal","relationships","setRelationships","streak","setStreak","formData","setFormData","estatus","note","dessert","empaty","comprehension","curiosity","learn_more","learn_from_you","miracle","username","localStorage","getItem","create","Date","toISOString","split","loadRelationships","token","res","get","headers","Authorization","params","data","err","response","status","console","error","toggle","relationshipId","relation","reverse","join","handleSubmit","e","preventDefault","post","children","fileName","_jsxFileName","lineNumber","columnNumber","as","to","variant","color","onClick","onRowClick","isOpen","_c","$RefreshReg$"],"sources":["C:/Users/faoa1/OneDrive/Escritorio/Sobis/frontend/src/pages/Relationship.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport Button from 'react-bootstrap/Button';\r\nimport axios from \"axios\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport RelationshipTable from \"../components/RelationshipTable\";\r\nimport RelationshipModal from \"../components/RelationshipModal\";\r\nimport NavScrollExample from \"../components/Navbar\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nconst Relationship = () => {\r\n    const navigate = useNavigate();\r\n    const [modal, setModal] = useState(false);\r\n    const [relationships, setRelationships] = useState([]);\r\n    const [streak, setStreak] = useState({});\r\n    const [formData, setFormData] = useState({\r\n        estatus: \"Good\",\r\n        note: \"\",\r\n        dessert: false,\r\n        empaty: \"\",\r\n        comprehension: \"\",\r\n        curiosity: \"\",\r\n        learn_more: \"\",\r\n        learn_from_you: \"\",\r\n        miracle: \"\",\r\n        username: localStorage.getItem(\"username\"),\r\n        create: new Date().toISOString().split('T')[0],\r\n    });\r\n\r\n    const username = localStorage.getItem(\"username\");\r\n\r\n    useEffect(() => {\r\n        loadRelationships();\r\n    }, []);\r\n\r\n    const loadRelationships = async () => {\r\n        const token = localStorage.getItem(\"token\");\r\n        const username = localStorage.getItem(\"username\");\r\n        if (!token || !username) return navigate(\"/login\");\r\n        try {\r\n            const res = await axios.get(\"http://localhost:8000/api/relationship/\", {\r\n                headers: { Authorization: `Bearer ${token}` },\r\n                params: { username } // <-- aquí agregas el parámetro\r\n            });\r\n            setRelationships(res.data.relationships);\r\n            setStreak(res.data.streak);\r\n        } catch (err) {\r\n            if (err.response && err.response.status === 401) {\r\n                navigate(\"/login\");\r\n            } else {\r\n                console.error(err);\r\n            }\r\n        }\r\n    };\r\n\r\n    const toggle = async (relationshipId = null) => {\r\n        if (relationshipId) {\r\n            const token = localStorage.getItem(\"token\");\r\n            if (!token) return navigate(\"/login\");\r\n            try {\r\n                const res = await axios.get(`http://localhost:8000/api/relationship/${relationshipId}/`, {\r\n                    headers: { Authorization: `Bearer ${token}` }\r\n                });\r\n                const relation = res.data;\r\n                setFormData({\r\n                    ...relation,\r\n                    create: relation.create.split('-').reverse().join('-'),\r\n                });\r\n            } catch (err) {\r\n                if (err.response && err.response.status === 401) {\r\n                    navigate(\"/login\");\r\n                } else {\r\n                    console.error(err);\r\n                }\r\n            }\r\n        } else {\r\n            setFormData({\r\n                estatus: \"Good\",\r\n                note: \"\",\r\n                dessert: false,\r\n                empaty: \"\",\r\n                comprehension: \"\",\r\n                curiosity: \"\",\r\n                learn_more: \"\",\r\n                learn_from_you: \"\",\r\n                miracle: \"\",\r\n                username: localStorage.getItem(\"username\"),\r\n                create: new Date().toISOString().split('T')[0],\r\n            });\r\n        }\r\n        setModal(!modal);\r\n    };\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        const token = localStorage.getItem(\"token\");\r\n        if (!token) return navigate(\"/login\");\r\n        try {\r\n            await axios.post(\"http://localhost:8000/api/relationship/\", formData, {\r\n                headers: { Authorization: `Bearer ${token}` }\r\n            });\r\n            toggle();\r\n            loadRelationships();\r\n        } catch (err) {\r\n            if (err.response && err.response.status === 401) {\r\n                navigate(\"/login\");\r\n            } else {\r\n                console.error(err);\r\n            }\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n        <NavScrollExample />\r\n      <Button as={Link} to=\"/dashboard\" variant=\"primary\">\r\n        Ir a Dashboard\r\n      </Button>\r\n        <Button as={Link} to=\"/finances\" variant=\"primary\">\r\n        Ir a Finanzas\r\n      </Button>\r\n        <div>\r\n            <h2>Relaciones {username}</h2>\r\n            <Button color=\"primary\" onClick={() => toggle()}>Agregar Relación</Button>\r\n            <h3>Racha: {streak.streak || 0} día(s)</h3>\r\n            <RelationshipTable relationships={relationships} onRowClick={toggle} />\r\n            <RelationshipModal isOpen={modal} toggle={toggle} formData={formData} setFormData={setFormData} handleSubmit={handleSubmit} />\r\n        </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default Relationship;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}